---
namespace: monk-redis

rds:
  defines: runnable

  metadata:
    name: Redis
    description: Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker.
    website: https://redis.io
    publisher: monk.io
    icon: https://cdn.icon-icons.com/icons2/2415/PNG/512/redis_original_wordmark_logo_icon_146369.png
  version: 1.0

  variables:
    image_tag:
      type: string
      value: latest
    redis_port:
      type: int
      value: 6379
    redis_disable_commands:
      env: REDIS_DISABLE_COMMANDS
      type: string
      value: FLUSHDB,FLUSHALL,CONFIG
    redis_empty_password:
      env: ALLOW_EMPTY_PASSWORD
      type: string
      value: yes
    redis_io_thread:
      env: REDIS_IO_THREADS
      type: string
      value: 1
    redis_io_threads_do_reads:
      env: REDIS_IO_THREADS_DO_READS
      type: string
      value: yes
    volume_data:
      type: string
      value: <- `${monk-volume-path}/redis`

  containers:
    monk-rds:
      paths:
        - <- `${volume_data}/mysql:/bitnami/redis/data`
      ports:
        - <- `0.0.0.0:${redis_port}:6379`
      image: bitnami/redis

  services:
    redis-svc:
      container: monk-rds
      port: 6379
      protocol: tcp
